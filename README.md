# MY BIM - å»ºç­‘ä¿¡æ¯æ¨¡å‹å¹³å°

ä¸€ä¸ªåŸºäºSpring Bootå’ŒReactçš„ç°ä»£åŒ–BIMï¼ˆå»ºç­‘ä¿¡æ¯æ¨¡å‹ï¼‰å¹³å°ï¼Œæ”¯æŒ3Dæ¨¡å‹ä¸Šä¼ ã€åœ¨çº¿æŸ¥çœ‹ã€é¡¹ç›®ç®¡ç†å’Œå›¢é˜Ÿåä½œã€‚

## ğŸš€ ä¸»è¦ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **ğŸ—ï¸ BIMé¡¹ç›®ç®¡ç†** - åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤å’Œç»„ç»‡BIMé¡¹ç›®
- **ğŸ“‚ 3Dæ¨¡å‹ç®¡ç†** - æ”¯æŒå¤šç§3Dæ¨¡å‹æ ¼å¼çš„ä¸Šä¼ å’Œç®¡ç†
- **ğŸ‘€ åœ¨çº¿3DæŸ¥çœ‹** - åŸºäºAutodesk Viewerçš„é«˜æ€§èƒ½3Dæ¨¡å‹æŸ¥çœ‹
- **ğŸ‘¥ ç”¨æˆ·æƒé™ç®¡ç†** - å®Œæ•´çš„ç”¨æˆ·è®¤è¯å’ŒåŸºäºè§’è‰²çš„æƒé™æ§åˆ¶
- **ğŸ”— é¡¹ç›®åˆ†äº«** - ç”Ÿæˆåˆ†äº«é“¾æ¥ï¼Œæ”¯æŒå…¬å¼€å’Œç§æœ‰åˆ†äº«
- **ğŸ·ï¸ æ ‡ç­¾ç³»ç»Ÿ** - çµæ´»çš„æ ‡ç­¾ç®¡ç†å’Œåˆ†ç±»åŠŸèƒ½
- **ğŸŒ å¤šè¯­è¨€æ”¯æŒ** - æ”¯æŒä¸­æ–‡å’Œè‹±æ–‡ç•Œé¢

### æŠ€æœ¯ç‰¹æ€§
- **ğŸ“± å“åº”å¼è®¾è®¡** - é€‚é…å„ç§è®¾å¤‡å’Œå±å¹•å°ºå¯¸
- **âš¡ é«˜æ€§èƒ½å­˜å‚¨** - æ”¯æŒMinIOå’Œåä¸ºäº‘OBSç­‰å¤šç§å­˜å‚¨åç«¯
- **ğŸ” å®‰å…¨è®¤è¯** - JWTä»¤ç‰Œè®¤è¯å’ŒSpring Securityé›†æˆ
- **ğŸ“Š æ•°æ®å®¡è®¡** - å®Œæ•´çš„æ“ä½œæ—¥å¿—å’Œæ•°æ®å˜æ›´è·Ÿè¸ª
- **ğŸ³ å®¹å™¨åŒ–éƒ¨ç½²** - Dockerå’ŒDocker Composeæ”¯æŒ
- **ğŸ“– APIæ–‡æ¡£** - é›†æˆSwaggerè‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯
- **Java 8** - ç¼–ç¨‹è¯­è¨€
- **Spring Boot 2.3.4** - åº”ç”¨æ¡†æ¶
- **Spring Security** - å®‰å…¨è®¤è¯
- **Spring Data JPA** - æ•°æ®è®¿é—®å±‚
- **Hibernate Envers** - æ•°æ®å®¡è®¡
- **MySQL** - å…³ç³»å‹æ•°æ®åº“
- **Druid** - æ•°æ®åº“è¿æ¥æ± 
- **JWT** - èº«ä»½è®¤è¯ä»¤ç‰Œ
- **Swagger** - APIæ–‡æ¡£ç”Ÿæˆ
- **Maven** - æ„å»ºå·¥å…·

### å‰ç«¯æŠ€æœ¯
- **React 16.13.1** - å‰ç«¯æ¡†æ¶
- **Ant Design 4.6.6** - UIç»„ä»¶åº“
- **React Router** - è·¯ç”±ç®¡ç†
- **Axios** - HTTPå®¢æˆ·ç«¯
- **i18next** - å›½é™…åŒ–æ¡†æ¶
- **Autodesk Viewer** - 3Dæ¨¡å‹æŸ¥çœ‹å™¨

### åŸºç¡€è®¾æ–½
- **Docker & Docker Compose** - å®¹å™¨åŒ–éƒ¨ç½²
- **Envoy Proxy** - åå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡
- **MinIO** - å¯¹è±¡å­˜å‚¨æœåŠ¡
- **åä¸ºäº‘OBS** - äº‘å­˜å‚¨æœåŠ¡ï¼ˆå¯é€‰ï¼‰

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾
```mermaid
graph TB
    subgraph "Client Layer"
        Web[Web Browser]
        Mobile[Mobile Device]
    end
    
    subgraph "Proxy Layer"
        Envoy[Envoy Proxy<br/>Load Balancer]
    end
    
    subgraph "Application Layer"
        Frontend[React Frontend<br/>Ant Design + Autodesk Viewer]
        Backend[Spring Boot Backend<br/>REST API + Security]
    end
    
    subgraph "Data Layer"
        MySQL[(MySQL Database<br/>Projects, Users, Models)]
        MinIO[(MinIO Object Storage<br/>3D Model Files)]
        Logs[Log Files<br/>Application Logs]
    end
    
    subgraph "External Services"
        Email[SMTP Server<br/>Email Service]
        OBS[Huawei Cloud OBS<br/>Alternative Storage]
    end
    
    Web --> Envoy
    Mobile --> Envoy
    Envoy --> Frontend
    Envoy --> Backend
    Frontend --> Backend
    Backend --> MySQL
    Backend --> MinIO
    Backend --> Email
    Backend --> OBS
    Backend --> Logs
    
    classDef clientClass fill:#e1f5fe
    classDef proxyClass fill:#f3e5f5
    classDef appClass fill:#e8f5e8
    classDef dataClass fill:#fff3e0
    classDef externalClass fill:#fce4ec
    
    class Web,Mobile clientClass
    class Envoy proxyClass
    class Frontend,Backend appClass
    class MySQL,MinIO,Logs dataClass
    class Email,OBS externalClass
```

### æŠ€æœ¯æ ˆæ¶æ„å›¾
```mermaid
graph TB
    subgraph "Frontend Technology Stack"
        React[React 16.13.1]
        AntD[Ant Design 4.6.6]
        Router[React Router]
        I18n[i18next]
        Axios[Axios HTTP Client]
        Viewer[Autodesk Viewer SDK]
    end
    
    subgraph "Backend Technology Stack"
        SpringBoot[Spring Boot 2.3.4]
        Security[Spring Security + JWT]
        JPA[Spring Data JPA]
        Hibernate[Hibernate + Envers]
        Swagger[Swagger API Docs]
        Validation[Bean Validation]
    end
    
    subgraph "Database & Storage"
        MySQL[MySQL 5.7+<br/>Druid Connection Pool]
        MinIO[MinIO Object Storage]
        Redis[Session Storage<br/>Spring Session JDBC]
    end
    
    subgraph "Infrastructure"
        Docker[Docker Containers]
        Compose[Docker Compose]
        Envoy[Envoy Proxy]
        Maven[Maven Build Tool]
    end
    
    React --> AntD
    React --> Router
    React --> I18n
    React --> Axios
    React --> Viewer
    
    SpringBoot --> Security
    SpringBoot --> JPA
    SpringBoot --> Hibernate
    SpringBoot --> Swagger
    SpringBoot --> Validation
    
    JPA --> MySQL
    SpringBoot --> MinIO
    Security --> Redis
    
    Docker --> SpringBoot
    Docker --> MySQL
    Docker --> MinIO
    Compose --> Docker
    Envoy --> SpringBoot
    Maven --> SpringBoot
    
    classDef frontendClass fill:#e3f2fd
    classDef backendClass fill:#e8f5e8
    classDef dataClass fill:#fff3e0
    classDef infraClass fill:#f3e5f5
    
    class React,AntD,Router,I18n,Axios,Viewer frontendClass
    class SpringBoot,Security,JPA,Hibernate,Swagger,Validation backendClass
    class MySQL,MinIO,Redis dataClass
    class Docker,Compose,Envoy,Maven infraClass
```

### ä¸šåŠ¡æµç¨‹æ—¶åºå›¾
```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant Frontend as React Frontend
    participant Envoy as Envoy Proxy
    participant Backend as Spring Boot API
    participant MySQL as MySQL DB
    participant MinIO as MinIO Storage
    participant Viewer as Autodesk Viewer
    
    Note over User,Viewer: BIMæ¨¡å‹ä¸Šä¼ å’ŒæŸ¥çœ‹æµç¨‹
    
    User->>Frontend: 1. ç™»å½•ç³»ç»Ÿ
    Frontend->>Envoy: 2. è®¤è¯è¯·æ±‚
    Envoy->>Backend: 3. è½¬å‘è®¤è¯
    Backend->>MySQL: 4. éªŒè¯ç”¨æˆ·
    MySQL-->>Backend: 5. ç”¨æˆ·ä¿¡æ¯
    Backend-->>Frontend: 6. JWT Token
    
    User->>Frontend: 7. åˆ›å»ºBIMé¡¹ç›®
    Frontend->>Backend: 8. é¡¹ç›®åˆ›å»ºè¯·æ±‚
    Backend->>MySQL: 9. ä¿å­˜é¡¹ç›®ä¿¡æ¯
    MySQL-->>Backend: 10. é¡¹ç›®ID
    Backend-->>Frontend: 11. é¡¹ç›®åˆ›å»ºæˆåŠŸ
    
    User->>Frontend: 12. ä¸Šä¼ 3Dæ¨¡å‹
    Frontend->>Backend: 13. è·å–ä¸Šä¼ URL
    Backend->>MinIO: 14. ç”Ÿæˆé¢„ç­¾åURL
    MinIO-->>Backend: 15. ä¸Šä¼ URL
    Backend-->>Frontend: 16. è¿”å›ä¸Šä¼ URL
    Frontend->>MinIO: 17. ç›´æ¥ä¸Šä¼ æ–‡ä»¶
    MinIO-->>Frontend: 18. ä¸Šä¼ å®Œæˆ
    Frontend->>Backend: 19. æ›´æ–°æ¨¡å‹ä¿¡æ¯
    Backend->>MySQL: 20. ä¿å­˜æ¨¡å‹å…ƒæ•°æ®
    
    User->>Frontend: 21. æŸ¥çœ‹3Dæ¨¡å‹
    Frontend->>Backend: 22. è·å–æ¨¡å‹åˆ—è¡¨
    Backend->>MySQL: 23. æŸ¥è¯¢æ¨¡å‹ä¿¡æ¯
    MySQL-->>Backend: 24. æ¨¡å‹å…ƒæ•°æ®
    Backend-->>Frontend: 25. æ¨¡å‹ä¿¡æ¯
    Frontend->>Viewer: 26. åˆå§‹åŒ–3DæŸ¥çœ‹å™¨
    Viewer->>MinIO: 27. åŠ è½½æ¨¡å‹æ–‡ä»¶
    MinIO-->>Viewer: 28. æ¨¡å‹æ•°æ®
    Viewer-->>User: 29. æ˜¾ç¤º3Dæ¨¡å‹
```

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- **Java**: 8+
- **Node.js**: 12.18.4+
- **MySQL**: 5.7+
- **Docker**: 19.03+
- **Docker Compose**: 1.25+

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd my-bim
```

### 2. ç¯å¢ƒé…ç½®
åˆ›å»º `.env` æ–‡ä»¶ï¼š
```bash
# æ•°æ®åº“é…ç½®
MYSQL_ROOT_PASSWORD=your_mysql_password
MYSQL_TZ=Asia/Shanghai

# MinIOé…ç½®
MINIO_ACCESS_KEY=your_minio_access_key
MINIO_SECRET_KEY=your_minio_secret_key
MINIO_EXTERNAL_ENDPOINT=http://localhost:9000
```

### 3. ä½¿ç”¨Docker Composeå¯åŠ¨
```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps
```

### 4. è®¿é—®åº”ç”¨
- **å‰ç«¯åº”ç”¨**: http://localhost:8081
- **APIæ–‡æ¡£**: http://localhost:8081/swagger-ui.html
- **MinIOæ§åˆ¶å°**: http://localhost:9001
- **æ•°æ®åº“ç›‘æ§**: http://localhost:8081/druid

## ğŸ”§ å¼€å‘ç¯å¢ƒæ­å»º

### åç«¯å¼€å‘
```bash
# å¯åŠ¨MySQLå’ŒMinIOæœåŠ¡
docker-compose up mysql minio -d

# åœ¨IDEä¸­å¯åŠ¨Spring Bootåº”ç”¨
# æˆ–ä½¿ç”¨Mavenå‘½ä»¤
./mvnw spring-boot:run
```

### å‰ç«¯å¼€å‘
```bash
cd src/main/frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm start
```

è®¿é—® http://localhost:3000 è¿›è¡Œå‰ç«¯å¼€å‘ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
my-bim/
â”œâ”€â”€ src/main/
â”‚   â”œâ”€â”€ java/com/zjjqtech/bimplatform/     # Javaæºä»£ç 
â”‚   â”‚   â”œâ”€â”€ controller/                    # RESTæ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ service/                       # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”œâ”€â”€ model/                         # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ repository/                    # æ•°æ®è®¿é—®å±‚
â”‚   â”‚   â””â”€â”€ security/                      # å®‰å…¨é…ç½®
â”‚   â”œâ”€â”€ resources/                         # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ frontend/                          # Reactå‰ç«¯åº”ç”¨
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ components/               # Reactç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ pages/                    # é¡µé¢ç»„ä»¶
â”‚       â”‚   â””â”€â”€ locales/                  # å›½é™…åŒ–æ–‡ä»¶
â”‚       â””â”€â”€ public/
â”‚           â””â”€â”€ sdk/                      # Autodesk Viewer SDK
â”œâ”€â”€ proxy/                                # Envoyä»£ç†é…ç½®
â”œâ”€â”€ docker-compose.yaml                  # å®¹å™¨ç¼–æ’é…ç½®
â””â”€â”€ Dockerfile                           # åº”ç”¨é•œåƒæ„å»ºæ–‡ä»¶
```

## ğŸ”‘ ä¸»è¦åŠŸèƒ½è¯¦è§£

### ç”¨æˆ·ç®¡ç†
- ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- å¿˜è®°å¯†ç å’Œé‡ç½®å¯†ç 
- åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶
- ç”¨æˆ·ä¸ªäººä¿¡æ¯ç®¡ç†

### é¡¹ç›®ç®¡ç†
- åˆ›å»ºå’Œç¼–è¾‘BIMé¡¹ç›®
- é¡¹ç›®æƒé™ç®¡ç†ï¼ˆæ‰€æœ‰è€…ã€åä½œè€…ï¼‰
- é¡¹ç›®æ ‡ç­¾å’Œåˆ†ç±»
- é¡¹ç›®æœç´¢å’Œç­›é€‰

### æ¨¡å‹ç®¡ç†
- å¤šæ ¼å¼3Dæ¨¡å‹ä¸Šä¼ 
- æ¨¡å‹æ–‡ä»¶ç®¡ç†
- ä¸»æ¨¡å‹è®¾ç½®
- æ¨¡å‹é‡å‘½åå’Œåˆ é™¤

### 3DæŸ¥çœ‹å™¨
- é«˜æ€§èƒ½3Dæ¨¡å‹æ¸²æŸ“
- å¤šæ¨¡å‹åŒæ—¶åŠ è½½
- è§†è§’æ§åˆ¶å’Œå¯¼èˆª
- æ„ä»¶é€‰æ‹©å’Œé«˜äº®
- æˆªå›¾åŠŸèƒ½

### åˆ†äº«åŠŸèƒ½
- ç”Ÿæˆé¡¹ç›®åˆ†äº«é“¾æ¥
- æ”¯æŒå…¬å¼€å’Œç§æœ‰åˆ†äº«
- åˆ†äº«æƒé™æ§åˆ¶

## ğŸ”§ é…ç½®è¯´æ˜

### æ•°æ®åº“é…ç½®
åœ¨ `application.yml` ä¸­é…ç½®MySQLè¿æ¥ï¼š
```yaml
spring:
  datasource.druid:
    url: jdbc:mysql://mysql:3306/bim?serverTimezone=Asia/Shanghai
    username: root
    password: ${MYSQL_ROOT_PASSWORD}
```

### å­˜å‚¨é…ç½®
æ”¯æŒMinIOå’Œåä¸ºäº‘OBSï¼š
```yaml
s3:
  endpoint: http://minio:9000
  accessKeyId: ${MINIO_ACCESS_KEY}
  accessKeySecret: ${MINIO_SECRET_KEY}
  bucketName: bim
```

### é‚®ä»¶é…ç½®
ç”¨äºå¯†ç é‡ç½®åŠŸèƒ½ï¼š
```yaml
spring:
  mail:
    host: smtp.qq.com
    username: your_email@qq.com
    password: your_email_password
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æ•°æ®åº“ç›‘æ§
è®¿é—® http://localhost:8081/druid æŸ¥çœ‹æ•°æ®åº“è¿æ¥æ± çŠ¶æ€å’ŒSQLæ‰§è¡Œæƒ…å†µã€‚

### åº”ç”¨ç›‘æ§
Spring Boot Actuatoræä¾›å¥åº·æ£€æŸ¥å’ŒæŒ‡æ ‡ç›‘æ§ï¼š
- å¥åº·æ£€æŸ¥: `/actuator/health`
- åº”ç”¨ä¿¡æ¯: `/actuator/info`

### æ—¥å¿—ç®¡ç†
- å¼€å‘ç¯å¢ƒï¼šæ§åˆ¶å°è¾“å‡º
- ç”Ÿäº§ç¯å¢ƒï¼šæ–‡ä»¶æ—¥å¿—ï¼ˆ`./logs/application.log`ï¼‰
- æ”¯æŒæ—¥å¿—è½®è½¬å’Œå‹ç¼©

## ğŸš€ éƒ¨ç½²æŒ‡å—

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
1. ä¿®æ”¹ `application.yml` ä¸­çš„ç”Ÿäº§é…ç½®
2. è®¾ç½®ç¯å¢ƒå˜é‡
3. ä½¿ç”¨ `-Pprod` é…ç½®æ–‡ä»¶æ„å»ºï¼š
   ```bash
   ./mvnw clean package -Pprod
   ```
4. éƒ¨ç½²åˆ°æœåŠ¡å™¨

### è´Ÿè½½å‡è¡¡
ä½¿ç”¨Envoyä»£ç†å®ç°è´Ÿè½½å‡è¡¡å’Œåå‘ä»£ç†ï¼Œé…ç½®æ–‡ä»¶ä½äº `proxy/envoy.yaml`ã€‚

## ğŸ§ª æµ‹è¯•

### è¿è¡Œå•å…ƒæµ‹è¯•
```bash
./mvnw test
```

### è¿è¡Œé›†æˆæµ‹è¯•
```bash
./mvnw verify
```

## ğŸ“š APIæ–‡æ¡£

åœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼Œå¯ä»¥è®¿é—® http://localhost:8081/swagger-ui.html æŸ¥çœ‹å®Œæ•´çš„APIæ–‡æ¡£ã€‚

ä¸»è¦APIç«¯ç‚¹ï¼š
- `/api/bim-project` - é¡¹ç›®ç®¡ç†
- `/api/user` - ç”¨æˆ·ç®¡ç†
- `/api/tag` - æ ‡ç­¾ç®¡ç†
- `/api/message` - æ¶ˆæ¯ç®¡ç†

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»ºPull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºè®¸å¯è¯ã€‚

## ğŸ“ è”ç³»æˆ‘ä»¬

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- åˆ›å»º Issue
- å‘é€é‚®ä»¶è‡³é¡¹ç›®ç»´æŠ¤è€…

---

**æ³¨æ„**: æœ¬é¡¹ç›®ä»…ç”¨äºå­¦ä¹ å’Œç ”ç©¶ç›®çš„ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å‰ï¼Œè¯·ç¡®ä¿è¿›è¡Œå……åˆ†çš„å®‰å…¨æ€§è¯„ä¼°å’Œæµ‹è¯•ã€‚
